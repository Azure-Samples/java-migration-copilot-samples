# Azure Architecture Diagram for Assets Manager

**Note**: To view this diagram properly, please install a Mermaid preview extension in VS Code.

## Architecture Overview
This is a microservices-based asset management system deployed on Azure Kubernetes Service (AKS). The architecture consists of two containerized Java Spring Boot services that work together to provide file upload, storage, and asynchronous image processing capabilities.

## Data Flow
1. **File Upload Flow**: Users interact with the web service to upload images
2. **Storage**: Uploaded files are stored in Azure Blob Storage 
3. **Message Processing**: When files are uploaded, messages are sent to Azure Service Bus queue
4. **Asynchronous Processing**: The worker service listens to the Service Bus queue and processes images (e.g., thumbnail generation)
5. **Database Operations**: Both services store and retrieve metadata from PostgreSQL database
6. **Authentication**: All Azure services use Managed Identity for secure, passwordless authentication

```mermaid
graph TD
%% Services
svcazurekubernetesservice_assetsmanagerweb["`Name: assets-manager-web
Path: web
Language: java
Port: 8080`"]
svcazurekubernetesservice_assetsmanagerworker["`Name: assets-manager-worker
Path: worker
Language: java
Port: 8080`"]
subgraph "Compute Resources"
%% Resources
subgraph akscluster["Azure Kubernetes Service (AKS) Cluster"]
azurekubernetesservice_assetsmanagerweb("`assets-manager-web (Containerized Service)`")
azurekubernetesservice_assetsmanagerworker("`assets-manager-worker (Containerized Service)`")
end
akscluster:::cluster
end
subgraph "Dependency Resources"
%% Dependency Resources
azurestorageaccount_azurestorage["`azure-storage (Azure Storage Account)`"]
azuredatabaseforpostgresql_postgresqldb["`postgresql-db (Azure Database for PostgreSQL)`"]
azureservicebus_servicebusqueue["`servicebus-queue (Azure Service Bus)`"]
end
%% Relationships
svcazurekubernetesservice_assetsmanagerweb --> |"hosted on"| azurekubernetesservice_assetsmanagerweb
azurekubernetesservice_assetsmanagerweb -.-> |"system-identity"| azurestorageaccount_azurestorage
azurekubernetesservice_assetsmanagerweb -.-> |"system-identity"| azuredatabaseforpostgresql_postgresqldb
azurekubernetesservice_assetsmanagerweb -.-> |"system-identity"| azureservicebus_servicebusqueue
svcazurekubernetesservice_assetsmanagerworker --> |"hosted on"| azurekubernetesservice_assetsmanagerworker
azurekubernetesservice_assetsmanagerworker -.-> |"system-identity"| azurestorageaccount_azurestorage
azurekubernetesservice_assetsmanagerworker -.-> |"system-identity"| azuredatabaseforpostgresql_postgresqldb
azurekubernetesservice_assetsmanagerworker -.-> |"system-identity"| azureservicebus_servicebusqueue
```

## Services Description
- **assets-manager-web**: Frontend web service handling user interactions, file uploads, and web UI
- **assets-manager-worker**: Background service processing uploaded images and generating thumbnails

## Azure Dependencies
- **Azure Storage Account**: Blob storage for uploaded images and generated thumbnails
- **Azure Database for PostgreSQL**: Stores image metadata and application data
- **Azure Service Bus**: Message queue for asynchronous communication between web and worker services